document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("form").forEach(function(e){e.addEventListener("submit",function(){e.querySelectorAll(".ignore_form").forEach(function(t){t.disabled=!0})})});const i=document.querySelectorAll("[data-tab]"),h=document.querySelectorAll("[data-for-tab]");function u(e){i.forEach(t=>{t.classList.toggle("active",t.dataset.tab===e)}),h.forEach(t=>{t.classList.toggle("active",t.dataset.forTab===e)})}if(i){i.forEach(t=>{t.addEventListener("click",()=>{u(t.dataset.tab)})});const e=document.querySelector("[data-tab].active");e&&u(e.dataset.tab)}document.querySelectorAll(".input-list-search").forEach(e=>{const t=e.querySelector("[data-url]"),l=e.querySelector('input[type="hidden"]'),a=e.querySelector(".custom-list"),c=t.dataset.url;let n;const d=s=>{a.innerHTML="",Array.isArray(s)&&s.length>0?s.forEach(r=>{const o=document.createElement("li");o.textContent=r.text,o.addEventListener("click",()=>{t.value=r.text,l.value=r.id,a.classList.add("hide")}),a.appendChild(o)}):a.innerHTML='<li style="color:#999;cursor:default;">Нічого не знайдено</li>'},y=()=>{clearTimeout(n),n=setTimeout(()=>{const s=t.value.trim().toLowerCase();if(c)axios.get(c,{params:{q:s}}).then(r=>{d(r.data.items||[]),a.classList.remove("hide")}).catch(r=>{console.error("AJAX error:",r)});else{let r=!1;a.querySelectorAll("li").forEach(o=>{const f=o.textContent.toLowerCase().includes(s);o.style.display=f?"block":"none",f&&(r=!0)}),r?a.classList.remove("hide"):a.classList.add("hide")}},300)};t.addEventListener("input",y),document.addEventListener("click",s=>{e.contains(s.target)||a.classList.add("hide")}),t.addEventListener("keydown",s=>{s.key==="Escape"&&a.classList.add("hide")})}),document.querySelectorAll(".tag-select").forEach(e=>{new Choices(e,{removeItemButton:!0,placeholderValue:"Виберіть або введіть...",searchPlaceholderValue:"Пошук...",duplicateItemsAllowed:!1})}),document.querySelectorAll(".image-upload").forEach(e=>{const t=e.querySelector('input[type="file"]'),l=e.querySelector("img");t.addEventListener("change",a=>{const c=a.target.files[0];if(c&&c.type.startsWith("image/")){const n=new FileReader;n.onload=function(d){l.src=d.target.result,l.style.display="block"},n.readAsDataURL(c)}else l.src="",l.style.display="none",alert("Будь ласка, виберіть зображення (JPEG, PNG, WEBP...)")})})});
