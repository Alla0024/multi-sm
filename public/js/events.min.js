document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("form").forEach(function(t){t.addEventListener("submit",function(){t.querySelectorAll(".ignore_form").forEach(function(e){e.disabled=!0})})});const i=document.querySelectorAll("[data-tab]"),y=document.querySelectorAll("[data-for-tab]");function u(t){i.forEach(e=>{e.classList.toggle("active",e.dataset.tab===t)}),y.forEach(e=>{e.classList.toggle("active",e.dataset.forTab===t)})}if(i){i.forEach(e=>{e.addEventListener("click",()=>{u(e.dataset.tab)})});const t=document.querySelector("[data-tab].active");t&&u(t.dataset.tab)}document.querySelectorAll(".input-list-search").forEach(t=>{const e=t.querySelector("[data-url]"),c=t.querySelector('input[type="hidden"]'),a=t.querySelector(".custom-list"),l=e.dataset.url;let n;const d=s=>{a.innerHTML="",Array.isArray(s)&&s.length>0?s.forEach(r=>{const o=document.createElement("li");o.textContent=r.text,o.addEventListener("click",()=>{e.value=r.text,c.value=r.id,a.classList.add("hide")}),a.appendChild(o)}):a.innerHTML='<li style="color:#999;cursor:default;">Нічого не знайдено</li>'},f=()=>{clearTimeout(n),n=setTimeout(()=>{const s=e.value.trim().toLowerCase();if(l)axios.get(l,{params:{q:s}}).then(r=>{d(r.data.items||[]),a.classList.remove("hide")}).catch(r=>{console.error("AJAX error:",r)});else{let r=!1;a.querySelectorAll("li").forEach(o=>{const h=o.textContent.toLowerCase().includes(s);o.style.display=h?"block":"none",h&&(r=!0)}),r?a.classList.remove("hide"):a.classList.add("hide")}},300)};e.addEventListener("focus",f),e.addEventListener("input",f),document.addEventListener("click",s=>{t.contains(s.target)||a.classList.add("hide")}),e.addEventListener("keydown",s=>{s.key==="Escape"&&a.classList.add("hide")})}),document.querySelectorAll(".tag-select").forEach(t=>{new Choices(t,{removeItemButton:!0,placeholderValue:"Виберіть або введіть...",searchPlaceholderValue:"Пошук...",duplicateItemsAllowed:!1})}),document.querySelectorAll(".image-upload").forEach(t=>{const e=t.querySelector('input[type="file"]'),c=t.querySelector("img");e.addEventListener("change",a=>{const l=a.target.files[0];if(l&&l.type.startsWith("image/")){const n=new FileReader;n.onload=function(d){c.src=d.target.result,c.style.display="block"},n.readAsDataURL(l)}else c.src="",c.style.display="none",alert("Будь ласка, виберіть зображення (JPEG, PNG, WEBP...)")})})});
